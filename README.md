# Утилиты для работы с чертежами в Space Engineers

Не найдя на просторах интернета ничего (может быть плохо искал?), что помогло бы мне выдрать из сценариев все чертежи, решил набросать эти скрипты. Ну и поделиться, вдруг пригодятся кому.

Хочу предупредить, что работают они только с PowerShell 7. Скачать его можно здесь:
https://github.com/PowerShell/PowerShell/releases

И еще одно предупреждение - скрипты пока работают только с файлом, который находится в той же папке, что и скрипт.

## Sandbox2Blueprints

Выдирает из файла мира все находящиеся в нем гриды и превращает их в файлы чертежа.

Перед запуском скрипта при необходмости можно внести изменения в настройки:

`$ClearOwner = $false` - оставлять ($false) или удалять ($true) информацию о изначальном владении объектом?

`$CreateMultiGrid = $true` - Создавать ($true) или нет ($false) чертежи объединенных объектов?

Для запуска надо разместить файл SANDBOX_0_0_0_.sbs в папку со скриптом и запустить скрипт командой
```
pwsh Sandbox2Blueprints.ps1
```
После выполнения скрипта в папке появятся множество папок с чертежами со следующим именованием
```
XXXX_Name Multi
```
где `XXXX` - это очередность, под каким данный грид был расположен в файле мира, `Name` - название грида, взятое из параметра DisplayName, `Multi` - добавляется только для объединенных объектов.

Также в случае если были сформированы объединенные объекты, в папке будет находиться файл `MultiList`, в котором будет указано название чертежа с мультиобъектами и номера одиночных объектов, из которых он состоит.
```
0063_PV-4-SV3 Multi - 0060 0061 0062 0063 0064
```
## CheckIntegrity
Формирует для чертежа файл с послойной схемой объекта и списком недостроенных блоков.

Для запуска надо разместить файл bp.sbc в папку со скриптом и запустить скрипт командой
```
pwsh CheckIntegrity.ps1
```
После выполнения скрипта в папке появятся файл `GridIntegrity`, в котором будет послойная схема объекта. Обозначения для схемы следующие: `.` - пустое место, `O` - место с блоком, `X` - место с недостроенным блоком. Также после схемы будут указаны координаты, тип блока и, если есть, название недостроеннного объекта.
```
Уровень -1

.........................
.........................
.........................
....OO..OO...............
....O...OO...............
....O...OO...............
.........................
....OOOOO....OOOXOOO.....
....OOO.OOOOOOOXOOOOXXX..
....OOOOOO.O.OOO...O.XX..
....OOO.OOOOOOOOOOOOOXX..
....OOOOO....OOOXOOO.....
.........................
....OO..OO...............
....O...OO...............
....O...OO...............
.........................
.........................
.........................

-8 7 LargeSteelCatwalk 
-7 6 LargeSteelCatwalkPlate 
-7 11 ButtonPanelLarge Button Panel 6
-7 12 LargeSteelCatwalk 
-7 13 LargeSteelCatwalk 
-6 12 LargeSteelCatwalkPlate 
-6 13 LargeSteelCatwalkPlate 
-5 12 LargeSteelCatwalk 
-5 13 LargeSteelCatwalk 
-4 7 LargeSteelCatwalk 
```
## GetBlocksList
Формирует для чертежа файл с послойной схемой объекта и списком блоков.

Для запуска надо разместить файл bp.sbc в папку со скриптом и запустить скрипт командой
```
pwsh CheckIntegrity.ps1
```
После выполнения скрипта в папке появятся файл `CheckList`, в котором будет послойная схема объекта. Обозначения для схемы следующие: `.` - пустое место, `O` - место с блоком. Также после схемы будут указаны тип блока и, если есть, его название. Названия блоков располагаются в порядке их появления на схеме.
```
Уровень -1

.........................
.........................
.........................
....OO..OO...............
....O...OO...............
....O...OO...............
.........................
....OOOOO....OOOOOOO.....
....OOO.OOOOOOOOOOOOOOO..
....OOOOOO.O.OOO...O.OO..
....OOO.OOOOOOOOOOOOOOO..
....OOOOO....OOOOOOO.....
.........................
....OO..OO...............
....O...OO...............
....O...OO...............
.........................
.........................
.........................

LargeBlockArmorCorner2Base 
LargeHydrogenTank Hydrogen Tank 2
LargeBlockArmorInvCorner2Tip 
LargeBlockArmorCorner2Base 
LargeBlockArmorSlope2Base 
LargeBlockArmorBlock 
LargeBlockArmorSlope2Base 
LargeBlockArmorCorner2Base 
LargeBlockArmorInvCorner2Tip 
...
```
# Планы по развитию
- [ ] Выбор обрабатываемого файла.
- [ ] Обработка всех файлов мира во вложенных папках.
- [ ] Получение чертежей, встроенных в проекторы.
- [ ] Удаление деформаций блоков.
- [ ] Удаление поведения ИИ.
- [ ] Меню для настройки параметров перед запуском основной части скрипта.
- [ ] Сравнение чертежей.
- [ ] Сделать CheckIntegrity и GetBlocksList более полезными и информативными. Сейчас это просто наброски для чего-то большего.
